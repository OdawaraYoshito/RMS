# NGINXサーバブロックの設定
server {
    # サーバがリクエストをリッスンするポートを指定
    listen 80;

    # サーバ名（今回はワイルドカードとして全てのリクエストを受け入れる）
    server_name _;

    # サーバのドキュメントルートを指定 (Laravelのpublicディレクトリ)
    root /var/www/html/public;

    # デフォルトで読み込むインデックスファイル
    index index.php;

    # メインのリクエスト処理
    location / {
        # ファイルが存在する場合はそのファイルを返す。
        # 存在しない場合はindex.phpにリクエストを渡す。
        try_files $uri $uri/ /index.php?$query_string;
    }

    # PHPファイルの処理
    location ~ \.php$ {
        # FastCGI用の設定ファイルを読み込む
        include fastcgi_params;

        # PHP-FPMにリクエストを転送（127.0.0.1:9000がPHP-FPMのデフォルトポート）
        fastcgi_pass 127.0.0.1:9000;

        # デフォルトで処理するファイルを指定
        fastcgi_index index.php;

        # 実際に実行するPHPスクリプトのパスを指定
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }

    # セキュリティ対策：隠しファイル（例：.htaccess）へのアクセスを禁止
    location ~ /\.ht {
        deny all;
    }
}
